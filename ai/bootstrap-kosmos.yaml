---
- name: Bootstrap Kosmos
  hosts: kosmos.xeno
  become: yes
  tasks:
    - name: Install package
      community.general.pacman:
        name:
          - base-devel
          - cmake
          - git
          - python
          - wget
          - btrfs-progs
          - python-pip
          - python-virtualenv
          - python-setuptools
          - uv
        state: present

    - name: Enable parallel compile
      ansible.builtin.lineinfile:
        path: /etc/makepkg.conf
        regexp: '^# *MAKEFLAGS="-j.*"'
        line: 'MAKEFLAGS="-j16"'
        owner: root
        group: root
        mode: '0644'

    - name: Create a directory for uv to install python
      ansible.builtin.file:
        path: /opt/python
        state: directory
        mode: '0755'
